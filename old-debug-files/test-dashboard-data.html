<!DOCTYPE html>
<html>
<head>
    <title>Dashboard Data Test</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1a1a2e;
            color: #fff;
        }
        .section {
            background: #0f3460;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .success { color: #4caf50; }
        .error { color: #f44336; }
        pre { 
            background: rgba(0,0,0,0.3);
            padding: 10px;
            overflow: auto;
        }
    </style>
</head>
<body>
    <h1>Smart Save Dashboard Data Test</h1>
    
    <div class="section">
        <h2>Testing API Endpoints...</h2>
        <div id="results"></div>
    </div>
    
    <script>
        async function testAPIs() {
            const results = document.getElementById('results');
            
            // Test 1: Projects API
            try {
                results.innerHTML += '<h3>Testing /api/projects...</h3>';
                const projectsResponse = await fetch('http://localhost:3737/api/projects');
                const projectsData = await projectsResponse.json();
                
                results.innerHTML += '<p class="success">✅ Projects API Working!</p>';
                results.innerHTML += '<pre>' + JSON.stringify(projectsData, null, 2) + '</pre>';
                
                // Display projects summary
                const realProjects = projectsData.projects.filter(p => !p.name.startsWith('TestProject') && p.files > 0);
                results.innerHTML += `<p>Found ${realProjects.length} real projects with files:</p><ul>`;
                realProjects.forEach(p => {
                    results.innerHTML += `<li>${p.name}: ${p.files} files, ${p.words.toLocaleString()} words</li>`;
                });
                results.innerHTML += '</ul>';
                
            } catch (error) {
                results.innerHTML += '<p class="error">❌ Projects API Error: ' + error.message + '</p>';
            }
            
            // Test 2: Stats API
            try {
                results.innerHTML += '<h3>Testing /api/stats...</h3>';
                const statsResponse = await fetch('http://localhost:3737/api/stats');
                const statsData = await statsResponse.json();
                
                results.innerHTML += '<p class="success">✅ Stats API Working!</p>';
                results.innerHTML += '<pre>' + JSON.stringify(statsData, null, 2) + '</pre>';
                
                // Display key stats
                results.innerHTML += '<h4>Key Statistics:</h4><ul>';
                results.innerHTML += `<li>Total Words: ${statsData.totalWords.toLocaleString()}</li>`;
                results.innerHTML += `<li>Total Files: ${statsData.totalFiles}</li>`;
                results.innerHTML += `<li>Memory References: ${statsData.memoryCount}</li>`;
                results.innerHTML += `<li>People Mentioned: ${statsData.peopleCount}</li>`;
                results.innerHTML += `<li>Bug References: ${statsData.bugsCount}</li>`;
                results.innerHTML += `<li>Solutions: ${statsData.solutionsCount}</li>`;
                results.innerHTML += `<li>Largest Project: ${statsData.largestProject.name} (${statsData.largestProject.words.toLocaleString()} words)</li>`;
                results.innerHTML += '</ul>';
                
            } catch (error) {
                results.innerHTML += '<p class="error">❌ Stats API Error: ' + error.message + '</p>';
            }
        }
        
        // Run tests on load
        testAPIs();
    </script>
</body>
</html>
